2024-07-12 00:03:43,799 - shared_logger - INFO - Current directory: C:\Users\patri\OneDrive\Documents\Patrick Learning\PyEzLoader\App
2024-07-12 00:03:43,800 - shared_logger - INFO - Base directory: C:\Users\patri\OneDrive\Documents\Patrick Learning\PyEzLoader
2024-07-12 00:03:43,800 - shared_logger - INFO - Pipelines folder: C:\Users\patri\OneDrive\Documents\Patrick Learning\PyEzLoader\Pipelines
2024-07-12 00:03:43,801 - shared_logger - INFO - Connections folder: C:\Users\patri\OneDrive\Documents\Patrick Learning\PyEzLoader\Connections
2024-07-12 00:03:43,801 - shared_logger - INFO - Schedules folder: C:\Users\patri\OneDrive\Documents\Patrick Learning\PyEzLoader\Schedules
2024-07-12 00:03:43,801 - shared_logger - INFO - Utilities folder: C:\Users\patri\OneDrive\Documents\Patrick Learning\PyEzLoader\Utilities
2024-07-12 00:03:43,802 - shared_logger - INFO - Pipelines folder exists. Contents:
2024-07-12 00:03:43,806 - shared_logger - INFO -   YAML file found: CSV2MSSQL.yaml
2024-07-12 00:03:43,806 - shared_logger - INFO -   Contents of CSV2MSSQL.yaml:
name: CSV2MSSQLTest
###############################################
############ Source Configuration #############
###############################################
source:
  connection_name: Dev_CSV_Jeopardy
###############################################
######## Transformation Configuration #########
###############################################
transformations:
  - type: add_timestamp
    column_name: created_at
###############################################
############ Target Configuration #############
###############################################
target:
  connection_name: Dev_MSSQL_Test
  action: drop_and_load
  schema_name: dbo
  table_name: testcsvtable
2024-07-12 00:03:43,811 - shared_logger - INFO -   YAML file found: CSV2Postgress.yaml
2024-07-12 00:03:43,811 - shared_logger - INFO -   Contents of CSV2Postgress.yaml:
name: CSV2PostgressTest
###############################################
############ Source Configuration #############
###############################################
source:
  connection_name: Dev_CSV_Jeopardy
###############################################
######## Transformation Configuration #########
###############################################
transformations:
  - type: add_timestamp
    column_name: created_at
###############################################
############ Target Configuration #############
###############################################
target:
  connection_name: Dev_PostGress_Test
  action: truncate_and_load
  schema_name: testschema
  table_name: testcsvtable
2024-07-12 00:03:43,812 - shared_logger - INFO -   YAML file found: CSV2PostgressAppendTest.yaml
2024-07-12 00:03:43,812 - shared_logger - INFO -   Contents of CSV2PostgressAppendTest.yaml:
name: CSV2PostgressAppendTest
###############################################
############ Source Configuration #############
###############################################
source:
  connection_name: Dev_CSV_Jeopardy
###############################################
######## Transformation Configuration #########
###############################################
transformations:
  - type: add_timestamp
    column_name: created_at
###############################################
############ Target Configuration #############
###############################################
target:
  connection_name: Dev_PostGress_Test
  action: append
  schema_name: testschema
  table_name: testcsvtable
2024-07-12 00:03:43,813 - shared_logger - INFO -   YAML file found: CSV2PostgressDropLoad.yaml
2024-07-12 00:03:43,814 - shared_logger - INFO -   Contents of CSV2PostgressDropLoad.yaml:
name: CSV2PostgressTestDropLoad
###############################################
############ Source Configuration #############
###############################################
source:
  connection_name: Dev_CSV_Jeopardy
###############################################
######## Transformation Configuration #########
###############################################
transformations:
  - type: add_timestamp
    column_name: created_at
###############################################
############ Target Configuration #############
###############################################
target:
  connection_name: Dev_PostGress_Test
  action: drop_and_load
  schema_name: testschema
  table_name: testcsvtable
2024-07-12 00:03:43,815 - shared_logger - INFO -   YAML file found: Excel2Postgress.yaml
2024-07-12 00:03:43,815 - shared_logger - INFO -   Contents of Excel2Postgress.yaml:
name: Excel2PostgressTest
###############################################
############ Source Configuration #############
###############################################
source:
  connection_name: Dev_Excel_WineMag
###############################################
######## Transformation Configuration #########
###############################################
transformations:
  - type: add_timestamp
    column_name: created_at
###############################################
############ Target Configuration #############
###############################################
target:
  connection_name: Dev_PostGress_Test
  action: truncate_and_load
  schema_name: testschema
  table_name: testtable
2024-07-12 00:03:43,816 - shared_logger - INFO -   YAML file found: Postgress2CSV.yaml
2024-07-12 00:03:43,816 - shared_logger - INFO -   Contents of Postgress2CSV.yaml:
name: Postgress2CSVTest
###############################################
############ Source Configuration #############
###############################################
source:
  connection_name: Dev_PostGress_Test
  query: select * from testschema.testcsvtable
###############################################
######## Transformation Configuration #########
###############################################
transformations:
  - type: add_timestamp
    column_name: created_at
  - type: clean_column_names
  - type: format_column_names
    format_type: camel_case
###############################################
######## Metadata Configuration ########
###############################################
add_metadata: true
###############################################
############ Target Configuration #############
###############################################
target:
  connection_name: Dev_CSV_JeopardyFromSQL
  action: replace

2024-07-12 00:03:43,817 - shared_logger - INFO -   YAML file found: Postgress2Excel.yaml
2024-07-12 00:03:43,817 - shared_logger - INFO -   Contents of Postgress2Excel.yaml:
name: Postgress2ExcelTest
###############################################
############ Source Configuration #############
###############################################
source:
  connection_name: Dev_PostGress_Test
  query: select * from testschema.testtable
###############################################
######## Transformation Configuration #########
###############################################
transformations:
  - type: add_timestamp
    column_name: created_at
  - type: clean_column_names
  - type: format_column_names
    format_type: upper
###############################################
######## Metadata Configuration ########
###############################################
add_metadata: true
###############################################
############ Target Configuration #############
###############################################
target:
  connection_name: Dev_Excel_WineMag_from_SQL
  action: replace
  sheet_name: testsheet99
  start_column: C
  start_row: 5

2024-07-12 00:03:43,819 - shared_logger - INFO - Connections folder exists. Contents:
2024-07-12 00:03:43,819 - shared_logger - INFO -   YAML file found: Dev_CSV_Jeopard.yaml
2024-07-12 00:03:43,819 - shared_logger - INFO -   Contents of Dev_CSV_Jeopard.yaml:
name: Dev_CSV_Jeopardy
type: CSV
file_path: C:/Users/patri/Downloads/JEOPARDY.csv
encoding: utf-8
delimiter: ","
2024-07-12 00:03:43,820 - shared_logger - INFO -   YAML file found: Dev_CSV_JeopardyFromSQL.yaml
2024-07-12 00:03:43,820 - shared_logger - INFO -   Contents of Dev_CSV_JeopardyFromSQL.yaml:
name: Dev_CSV_JeopardyFromSQL
type: CSV
file_path: C:/Users/patri/Downloads/JEOPARDY_fromSQL.csv
encoding: utf-8
delimiter: ","
2024-07-12 00:03:43,820 - shared_logger - INFO -   YAML file found: Dev_Excel_Test.yaml
2024-07-12 00:03:43,821 - shared_logger - INFO -   Contents of Dev_Excel_Test.yaml:
name: Dev_Excel_WineMag_from_SQL
type: Excel
file_path: C:/Users/patri/Downloads/winemag-data-130k-v2_from_SQL.xlsx


2024-07-12 00:03:43,821 - shared_logger - INFO -   YAML file found: Dev_Excel_WineMag.yaml
2024-07-12 00:03:43,821 - shared_logger - INFO -   Contents of Dev_Excel_WineMag.yaml:
name: Dev_Excel_WineMag
type: Excel
file_path: C:/Users/patri/Downloads/winemag-data-130k-v2.xlsx
sheet_name: notsheet1
header_start_row: 1
column_start_row: 1

2024-07-12 00:03:43,822 - shared_logger - INFO -   YAML file found: Dev_MSSQL_Test.yaml
2024-07-12 00:03:43,823 - shared_logger - INFO -   Contents of Dev_MSSQL_Test.yaml:
############# Basic Info #################
name: Dev_MSSQL_Test
type: MSSQL
############# Credentials ################
username: SA
password: YourStrongPassword123!
############# Connection ################
server: 127.0.0.1
database: testdatabase
schema: dbo
encrypt: yes


2024-07-12 00:03:43,823 - shared_logger - INFO - Schedules folder exists. Contents:
2024-07-12 00:03:43,823 - shared_logger - INFO -   YAML file found: schedules.yaml
2024-07-12 00:03:43,824 - shared_logger - INFO -   Contents of schedules.yaml:
schedules:
  daily_schedule:
    schedule_type: daily
    time: "10:00"

  hourly_schedule:
    schedule_type: hourly
    minute: 30

  weekly_schedule:
    schedule_type: cron
    cron: "0 0 * * 0"

  monthly_schedule:
    schedule_type: cron
    cron: "0 0 1 * *"

  first_of_month_schedule:
    schedule_type: cron
    cron: "0 0 1 * *"

  last_of_month_schedule:
    schedule_type: cron
    cron: "0 0 L * *"

  first_plus_days_schedule:
    schedule_type: cron
    cron: "0 0 10 * *"
    days_offset: 5

  last_minus_one_day_schedule:
    schedule_type: cron
    cron: "0 0 L * *"
    days_offset: -1

2024-07-12 00:03:43,825 - shared_logger - ERROR - Utilities folder does not exist: C:\Users\patri\OneDrive\Documents\Patrick Learning\PyEzLoader\Utilities
2024-07-12 00:03:43,827 - shared_logger - INFO - Loaded pipeline configuration for CSV2MSSQLTest
2024-07-12 00:03:43,828 - shared_logger - INFO - Loaded pipeline configuration for CSV2PostgressTest
2024-07-12 00:03:43,829 - shared_logger - INFO - Loaded pipeline configuration for CSV2PostgressAppendTest
2024-07-12 00:03:43,831 - shared_logger - INFO - Loaded pipeline configuration for CSV2PostgressTestDropLoad
2024-07-12 00:03:43,832 - shared_logger - INFO - Loaded pipeline configuration for Excel2PostgressTest
2024-07-12 00:03:43,833 - shared_logger - INFO - Loaded pipeline configuration for Postgress2CSVTest
2024-07-12 00:03:43,835 - shared_logger - INFO - Loaded pipeline configuration for Postgress2ExcelTest
2024-07-12 00:03:43,835 - shared_logger - INFO - Loading connections from folder: C:\Users\patri\OneDrive\Documents\Patrick Learning\PyEzLoader\Connections
2024-07-12 00:03:43,836 - shared_logger - INFO - Loaded connection config: Dev_CSV_Jeopardy
2024-07-12 00:03:43,837 - shared_logger - INFO - Loaded connection config: Dev_CSV_JeopardyFromSQL
2024-07-12 00:03:43,837 - shared_logger - INFO - Loaded connection config: Dev_Excel_WineMag_from_SQL
2024-07-12 00:03:43,838 - shared_logger - INFO - Loaded connection config: Dev_Excel_WineMag
2024-07-12 00:03:43,839 - shared_logger - INFO - Loaded connection config: Dev_MSSQL_Test
2024-07-12 00:03:43,839 - shared_logger - INFO - Loaded connections: dict_keys(['Dev_CSV_Jeopardy', 'Dev_CSV_JeopardyFromSQL', 'Dev_Excel_WineMag_from_SQL', 'Dev_Excel_WineMag', 'Dev_MSSQL_Test'])
2024-07-12 00:03:43,839 - shared_logger - INFO - Setting up source connection: Dev_CSV_Jeopardy
2024-07-12 00:03:43,839 - shared_logger - INFO - Setting up target connection: Dev_MSSQL_Test, action: drop_and_load, schema: dbo, table: testcsvtable
2024-07-12 00:03:43,839 - shared_logger - INFO - Pipeline run: CSV2MSSQLTest
2024-07-12 00:03:43,839 - shared_logger - INFO - Reading source data
2024-07-12 00:03:44,115 - shared_logger - INFO - Source data read successfully. Rows: 216930
2024-07-12 00:03:44,116 - shared_logger - INFO - Data read from source. Rows: 216930
2024-07-12 00:03:44,117 - shared_logger - INFO - Data transformed
2024-07-12 00:03:44,118 - shared_logger - INFO - Writing target data
2024-07-12 00:03:44,275 - shared_logger - INFO - Table dbo.testcsvtable created.
2024-07-12 00:07:45,537 - shared_logger - INFO - Target data written successfully. Rows: 216930
2024-07-12 00:07:45,538 - shared_logger - INFO - Pipeline run completed successfully: CSV2MSSQLTest
2024-07-12 00:07:45,538 - shared_logger - INFO - 
Pipeline Summary for CSV2MSSQLTest:
Status: Success
Source Rows: 216930
Target Rows: 216930 

2024-07-12 00:07:45,545 - shared_logger - INFO - Script execution completed.
